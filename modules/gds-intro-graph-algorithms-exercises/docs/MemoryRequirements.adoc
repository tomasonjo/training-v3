= Memory Requirements
:icons: font

== Memory Requirements (Preparations)

The database you start with should contain all of the data you loaded in the setup for this course.

This is what you should see when you click the database icon image:database-icon.png[].

image::LoadedDatabase.png[LoadedDatabase,width=150]

{nbsp} +

If you do not see this in your Neo4j Browser, you will need to perform the setup steps again.

== Memory Requirements (Graph Catalog)

The projected graphs *roads* and *dach-region* should be created and stored in the GDS graph catalog.

This is what you should see when you execute the following query:

[source, cypher]
----
CALL gds.graph.list()
YIELD graphName, nodeCount, relationshipCount
----

image::LoadedRoadsGraph.png[LoadedDatabase]

{nbsp} +

If you do not see this in your Neo4j Browser, you will need to perform the graph catalog steps again.

== Memory Requirements (Overview)

Before you run a graph algorithm, it is helpful to understand what the memory requirements will be for loading the data for the analysis, as well as the memory that will be required to run the algorithm. The `estimate()` function is used to provide you with this information and is available for the production-quality tier algorithms.

In this exercise, you will determine the memory requirements for each algorithm on the datasets you have been working with:

* *Part 1*: Determine the memory requirements for loading each of the datasets.
* *Part 2*: Determine the memory requirements for running algorithms on these graphs.

Go to the next page to start this exercise.

== Part 1: Determine the memory requirements for loading each of the datasets. (Instructions)

Write the Cypher code to determine the memory requirements for loading these graphs:

* Game of Thrones dataset using the *Character* nodes and the *INTERACTS_SEASON1* relationships.
* Game of Thrones dataset using the *Character* nodes and the *INTERACTS_SEASON1* relationships with included relationship weight property.
* European roads dataset using the *Place* nodes and the *EROADS* relationships with included relationship weight property.


== Part 1: Determine the memory requirements for loading each of the datasets. (Solution)

Write the Cypher code to determine the memory requirements for loading these graphs:

* Game of Thrones dataset using the *Character* nodes and the *INTERACTS_SEASON1* relationships.

Here is the solution code:

[source, cypher]
----
CALL gds.graph.create.estimate('Character', 'INTERACTS_SEASON1')
YIELD requiredMemory
----

This load requires 299 KiB of memory.

* Game of Thrones dataset using the *Character* nodes and the *INTERACTS_SEASON1* relationships with included relationship weight property.

Here is the solution code:

[source, cypher]
----
CALL gds.graph.create.estimate('Character', 'INTERACTS_SEASON1', 
    {relationshipProperties:'weight'})
YIELD requiredMemory
----

This load requires 563 KiB of memory.

* European roads dataset using the *Place* nodes and the *EROADS* relationships with included relationship weight property.

Here is the solution code:

[source, cypher]
----
CALL gds.graph.create.estimate('Place', 'EROAD', 
    {relationshipProperties:'inverse_distance'})
YIELD requiredMemory
----

This load requires 567 KiB of memory.

== Part 2: Determine the memory requirements for running algorithms on these graphs. (Instructions)

Write the Cypher code to determine the memory requirements for running these algorithms on these graphs:

* PageRank on the European roads dataset.
* Betweenness centrality on the DACH region of the European roads dataset.
* Weakly Connected Components on the Game of Thrones dataset using the *Character* nodes and the *INTERACTS_SEASON1* relationships.
* Louvain Modularity on the Game of Thrones dataset using the *Character* nodes and the *INTERACTS_SEASON5* relationships.

== Part 2: Determine the memory requirements for running algorithms on these graphs. (Solution)

Write the Cypher code to determine the memory requirements for running these algorithms on these graphs:

* PageRank on the European roads dataset.

Here is the solution code:

[source, cypher]
----
CALL gds.pageRank.stream.estimate('roads')
YIELD requiredMemory
----

This algorithm requires 29 KiB of memory.

* Betweenness centrality on the DACH region of the European roads dataset.

Here is the solution code:

[source, cypher]
----
CALL gds.betweenness.stream.estimate('dach-region')
YIELD requiredMemory
----

This algorithm requires 37 KiB of memory.

* Weakly Connected Components on the Game of Thrones dataset using the *Character* nodes and the *INTERACTS_SEASON1* relationships.

Here is the solution code:

[source, cypher]
----
CALL gds.wcc.write.estimate({nodeProjection:'Character', 
                             relationshipProjection:'INTERACTS_SEASON1',
                             writeProperty:'wcc'})
YIELD requiredMemory
----

This algorithm requires 302 KiB of memory.

* Louvain Modularity on the Game of Thrones dataset using the *Character* nodes and the *INTERACTS_SEASON5* relationships.

Here is the solution code:

[source, cypher]
----
CALL gds.louvain.stream.estimate({
    nodeProjection:'Character', 
    relationshipProjection:'INTERACTS_SEASON5'})
YIELD requiredMemory
----

This algorithm requires 329 KiB to 951 KiB of memory.

== Memory Requirements: Taking it further

Calculate memory requirements for different combinations of graphs and algorithms.

== Memory Requirements (Summary)

In this exercise, you gained some experience estimating the memory requirements for loading graphs into memory and executing some production-tier algorithms.

