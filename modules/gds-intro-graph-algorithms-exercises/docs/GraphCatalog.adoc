= Graph Catalog
:icons: font

== Graph Catalog (Preparations)

The database you start with should contain all of the data you loaded in the setup for this course.

This is what you should see when you click the database icon image:database-icon.png[].

image::LoadedDatabase.png[LoadedDatabase,width=150]

{nbsp} +

If you do not see this in your Neo4j Browser, you will need to perform the setup steps again.

== Graph Catalog (Overview)

The graph catalog is a concept within the GDS library that allows managing multiple graph projections by name.
Using its name, a created graph can be used many times in the analytical workflow.

In this exercise, you will gain some experience with writing Cypher to create a graph in the Graph Catalog.

* *Part 1*: Project a graph to Graph Catalog with native projection.
* *Part 2*: Project a subgraph to Graph Catalog with cypher projection.

Go to the next page to start this exercise.

== Part 1: Project a graph to Graph Catalog with native projection. (Instructions)

Write Cypher code to project the European Roads graph to Graph Catalog using these guidelines:

* The created graph should be named *roads*.
* Project all nodes labeled *Place*.
* Project all relationships with a type *EROAD*.
* Relationships should use the *UNDIRECTED* orientation.
* Include *inverse_distance* property as a relationship property.
* Set the default value for *inverse_distance* relationship property to be 1.0.

*Hint*: You will call `gds.graph.create`.

== Part 1: Project a graph to Graph Catalog with native projection. (Solution)

Write Cypher code to project the European Roads graph to Graph Catalog using these guidelines:

* The created graph should be named *roads*.
* Project all nodes labeled *Place*.
* Project all relationships with a type *EROAD*.
* Relationships should use the *UNDIRECTED* orientation.
* Include *inverse_distance* property as a relationship property.
* Set the default value for *inverse_distance* relationship property to be 1.0.

*Hint*: You will call `gds.graph.create`.

[source, cypher]
----
CALL gds.graph.create('roads','Place',
    {EROAD:{
        type:"EROAD",
        orientation:"UNDIRECTED",
        properties:{
            inverse_distance:{
                property:"inverse_distance",
                defaultValue:1.0
            }
        }
    }
})
----

== Part 2: Project a subgraph to Graph Catalog with cypher projection. (Instructions/Solution)

Write Cypher code to project the European Roads graph to Graph Catalog using these guidelines:

* The created graph should be named *dach-region*.
* Project all nodes labeled *Place* that have one of the following country codes: *D*, *A*, or *CH*
* Project all relationships with a type *EROAD* and treat them as *UNDIRECTED*.
* Include *inverse_distance* property as a relationship property.
* Set the default value for *inverse_distance* relationship property to be 1.0.

*Hint*: You will call `gds.graph.create.cypher`.

[source, cypher]
----
CALL gds.graph.create.cypher('dach-region',
   'MATCH (p:Place) 
    WHERE p.countryCode in ["D", "A", "CH"]
    RETURN id(p) as id',
   'MATCH (s:Place)-[r:EROAD]-(t:Place)
    RETURN id(s) as source,id(t) as target, coalesce(r.inverse_distance,1.0) as inverse_distance'
    , {validateRelationships:false})
----

== Graph Catalog: Taking it further

. Try projecting the Game of Thrones network.
. Try using different filters with cypher projection

== Graph Catalog (Summary)

In this exercise, you gained some experience with writing Cypher code to store the projected graph in Graph Catalog using the European Roads dataset.
This procedure enables you to reuse the same projected graph in the analytical workflow.

